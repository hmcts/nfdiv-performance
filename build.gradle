plugins {
  id 'org.owasp.dependencycheck' version '6.0.3'
  id 'io.gatling.gradle' version '3.4.2'
  id "scala"
  id 'groovy'
  id 'com.gradle.plugin-publish' version '0.9.8'
  id 'maven-publish'
}

apply plugin: "scala"
group 'uk.gov.hmcts.reform'
version = '1.0'

sourceCompatibility = "11"
targetCompatibility = "11"

repositories {
  jcenter()
}

sourceSets {
  gatling {
    scala.srcDirs = ["src/gatling/simulations/"]
  }
}

jar {
  manifest {
    attributes 'Main-Class': 'io.gatling.app.Gatling'
  }
  from {
    configurations.testCompile.collect { it.isDirectory() ? it : zipTree(it) }
  }
  from sourceSets.test.output
  exclude 'META-INF/*.RSA', 'META-INF/*.SF', 'META-INF/*.DSA'
}

ext {
  gatlingVersion = '3.3.1'
  scalaVersion = '2.13.3'
}

dependencies {
  compile group:"org.yaml", name: "snakeyaml", version:"1.26"
  testCompile group: 'org.scala-lang', name: 'scala-library', version: scalaVersion
  testCompile group: 'io.gatling.highcharts', name: 'gatling-charts-highcharts', version: gatlingVersion
  testCompile group: 'io.gatling', name: 'gatling-app', version: gatlingVersion
  gatling group: 'io.rest-assured', name: 'rest-assured', version: '4.3.1'
  gatlingImplementation 'com.warrenstrange:googleauth:1.5.0'
  gatlingRuntimeOnly group: 'io.gatling.highcharts', name: 'gatling-charts-highcharts', version: gatlingVersion
}

gatling {
  toolVersion '3.2.0'
  scalaVersion '2.12.8'
  jvmArgs = ['-Xms1024m', '-Xmx2048m']
  simulations = {
    include "simulations/Fact_Jenkins.scala"
  }
}
